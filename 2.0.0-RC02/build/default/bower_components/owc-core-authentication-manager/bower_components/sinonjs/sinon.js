(function(c,d){'use strict';'function'===typeof define&&define.amd?define('sinon',[],function(){return c.sinon=d()}):'object'===typeof exports?module.exports=d():c.sinon=d()})(this,function(){'use strict';var samsam,formatio,lolex;(function(){function define(c,d,g){'samsam'==c?samsam=d():'function'===typeof d&&0===c.length?lolex=d():'function'===typeof g&&(formatio=g(samsam))}define.amd={},('function'===typeof define&&define.amd&&function(c){define('samsam',c)}||'object'===typeof module&&function(c){module.exports=c()}||function(c){this.samsam=c()})(function(){function c(P){return'number'===typeof P&&P!==P}function d(P){return O.toString.call(P).split(/[ \]]/)[1]}function g(P){if('Arguments'===d(P))return!0;if('object'!==typeof P||'number'!==typeof P.length||'Array'===d(P))return!1;if('function'==typeof P.callee)return!0;try{P[P.length]=6,delete P[P.length]}catch(q){return!0}return!1}function y(P){if(!P||1!==P.nodeType||!R)return!1;try{P.appendChild(R),P.removeChild(R)}catch(q){return!1}return!0}function C(P){var N,q=[];for(N in P)O.hasOwnProperty.call(P,N)&&q.push(N);return q}function w(P){return'function'==typeof P.getTime&&P.getTime()==P.valueOf()}function A(P){return 0===P&&1/P===-Infinity}function E(P,q){if(P===q||c(P)&&c(q))return 0!==P||A(P)===A(q)}function S(P,q){if(0===q.length)return!0;var N,D,L,M;for(N=0,D=P.length;N<D;++N)if(I(P[N],q[0])){for(L=0,M=q.length;L<M;++L)if(!I(P[N+L],q[L]))return!1;return!0}return!1}var I,O=Object.prototype,R='undefined'!==typeof document&&document.createElement('div');return I=function P(q,N){if(N&&'function'===typeof N.test)return N.test(q);if('function'===typeof N)return!0===N(q);if('string'===typeof N){N=N.toLowerCase();return('string'===typeof q||!!q)&&0<=(q+'').toLowerCase().indexOf(N)}if('number'===typeof N)return N===q;if('boolean'===typeof N)return N===q;if('undefined'===typeof N)return'undefined'===typeof q;if(null===N)return null===q;if('Array'===d(q)&&'Array'===d(N))return S(q,N);if(N&&'object'===typeof N){if(N===q)return!0;for(var L in N){var M=q[L];if('undefined'===typeof M&&'function'===typeof q.getAttribute&&(M=q.getAttribute(L)),null===N[L]||'undefined'===typeof N[L]){if(M!==N[L])return!1;}else if('undefined'===typeof M||!P(M,N[L]))return!1}return!0}throw new Error('Matcher was not a string, a number, a function, a boolean or an object')},{isArguments:g,isElement:y,isDate:w,isNegZero:A,identical:E,deepEqual:function(P,q){function N(_){return'object'!==typeof _||null===_||_ instanceof Boolean||_ instanceof Date||_ instanceof Number||_ instanceof RegExp||_ instanceof String?!1:!0}function D(_,V){var B;for(B=0;B<_.length;B++)if(_[B]===V)return B;return-1}var L=[],M=[],X=[],H=[],W={};return function _(V,B,U,G){var K=typeof V,z=typeof B;if(V===B||c(V)||c(B)||null==V||null==B||'object'!==K||'object'!==z)return E(V,B);if(y(V)||y(B))return!1;var $=w(V),Z=w(B);if(($||Z)&&(!$||!Z||V.getTime()!==B.getTime()))return!1;if(V instanceof RegExp&&B instanceof RegExp&&V.toString()!==B.toString())return!1;var J=d(V),Y=d(B),Q=C(V),ee=C(B);if(g(V)||g(B)){if(V.length!==B.length)return!1;}else if(K!==z||J!==Y||Q.length!==ee.length)return!1;var te,ne,ae,re,oe,se,le,ie,ce,de,ue;for(ne=0,ae=Q.length;ne<ae;ne++){if(te=Q[ne],!O.hasOwnProperty.call(B,te))return!1;if(re=V[te],oe=B[te],se=N(re),le=N(oe),ie=se?D(L,re):-1,ce=le?D(M,oe):-1,de=-1===ie?U+'['+JSON.stringify(te)+']':X[ie],ue=-1===ce?G+'['+JSON.stringify(te)+']':H[ce],W[de+ue])return!0;if(-1===ie&&se&&(L.push(re),X.push(de)),-1===ce&&le&&(M.push(oe),H.push(ue)),se&&le&&(W[de+ue]=!0),!_(re,oe,de,ue))return!1}return!0}(P,q,'$1','$2')},match:I,keys:C}}),('function'===typeof define&&define.amd&&function(c){define('formatio',['samsam'],c)}||'object'===typeof module&&function(c){module.exports=c(require('samsam'))}||function(c){this.formatio=c(this.samsam)})(function(c){function d(S){if(!S)return'';if(S.displayName)return S.displayName;if(S.name)return S.name;var O=S.toString().match(/function\s+([^\(]+)/m);return O&&O[1]||''}function g(S,O){var P,q,R=d(O&&O.constructor),I=S.excludeConstructors||A.excludeConstructors||[];for(P=0,q=I.length;P<q;++P){if('string'===typeof I[P]&&I[P]===R)return'';if(I[P].test&&I[P].test(R))return''}return R}function y(S,O){if('object'!==typeof S)return!1;var R,I;for(R=0,I=O.length;R<I;++R)if(O[R]===S)return!0;return!1}function C(S,O,R,I){if('string'===typeof O){var P=S.quoteStrings;return R||'boolean'!==typeof P||P?'"'+O+'"':O}if('function'===typeof O&&!(O instanceof RegExp))return C.func(O);if(R=R||[],y(O,R))return'[Circular]';if('[object Array]'===Object.prototype.toString.call(O))return C.array.call(S,O,R);if(!O)return(1/O===-Infinity?'-0':O)+'';if(c.isElement(O))return C.element(O);if('function'===typeof O.toString&&O.toString!==Object.prototype.toString)return O.toString();var N,D;for(N=0,D=T.length;N<D;N++)if(O===T[N].object)return T[N].value;return C.object.call(S,O,R,I)}function w(S){for(var O in S)this[O]=S[O]}var A={excludeConstructors:['Object',/^.$/],quoteStrings:!0,limitChildrenCount:0},E=Object.prototype.hasOwnProperty,T=[];return'undefined'!==typeof global&&T.push({object:global,value:'[object global]'}),'undefined'!==typeof document&&T.push({object:document,value:'[object HTMLDocument]'}),'undefined'!==typeof window&&T.push({object:window,value:'[object Window]'}),C.func=function(S){return'function '+d(S)+'() {}'},C.array=function(S,O){O=O||[],O.push(S);var I,P,R=[];for(P=0<this.limitChildrenCount?Math.min(this.limitChildrenCount,S.length):S.length,I=0;I<P;++I)R.push(C(this,S[I],O));return P<S.length&&R.push('[... '+(S.length-P)+' more elements]'),'['+R.join(', ')+']'},C.object=function(S,O,R){O=O||[],O.push(S),R=R||0;var N,D,L,M,X,H,I=[],P=c.keys(S).sort(),q=3;for(H=0<this.limitChildrenCount?Math.min(this.limitChildrenCount,P.length):P.length,M=0;M<H;++M)N=P[M],L=S[N],D=y(L,O)?'[Circular]':C(this,L,O,R+2),D=(/\s/.test(N)?'"'+N+'"':N)+': '+D,q+=D.length,I.push(D);var W=g(this,S),_=W?'['+W+'] ':'',V='';for(M=0,X=R;M<X;++M)V+=' ';return H<P.length&&I.push('[... '+(P.length-H)+' more elements]'),80<q+R?_+'{\n  '+V+I.join(',\n  '+V)+'\n'+V+'}':_+'{ '+I.join(', ')+' }'},C.element=function(S){var I,q,N,D,L,O=S.tagName.toLowerCase(),R=S.attributes,P=[];for(N=0,D=R.length;N<D;++N)I=R.item(N),q=I.nodeName.toLowerCase().replace('html:',''),L=I.nodeValue,'contenteditable'===q&&'inherit'===L||!L||P.push(q+'="'+L+'"');var M='<'+O+(0<P.length?' ':''),X=S.innerHTML;20<X.length&&(X=X.substr(0,20)+'[...]');var H=M+P.join(' ')+'>'+X+'</'+O+'>';return H.replace(/ contentEditable="inherit"/,'')},w.prototype={functionName:d,configure:function(S){return new w(S)},constructorName:function(S){return g(this,S)},ascii:function(S,O,R){return C(this,S,O,R)}},w.prototype}),!function(c){if('object'==typeof exports&&'undefined'!=typeof module)module.exports=c();else if('function'==typeof define&&define.amd)define([],c);else{var d;'undefined'==typeof window?'undefined'==typeof global?'undefined'!=typeof self&&(d=self):d=global:d=window,d.lolex=c()}}(function(){var define,module,exports;return function c(d,g,y){function C(E,T){if(!g[E]){if(!d[E]){var S='function'==typeof require&&require;if(!T&&S)return S(E,!0);if(w)return w(E,!0);var O=new Error('Cannot find module \''+E+'\'');throw O.code='MODULE_NOT_FOUND',O}var R=g[E]={exports:{}};d[E][0].call(R.exports,function(I){var P=d[E][1][I];return C(P?P:I)},R,R.exports,c,d,g,y)}return g[E].exports}for(var w='function'==typeof require&&require,A=0;A<y.length;A++)C(y[A]);return C}({1:[function(require,module,exports){(function(global){(function(global){function parseTime(c){if(!c)return 0;var w,d=c.split(':'),g=d.length,y=g,C=0;if(3<g||!/^(\d\d:){0,2}\d\d?$/.test(c))throw new Error('tick only understands numbers and \'h:m:s\'');for(;y--;){if(w=parseInt(d[y],10),60<=w)throw new Error('Invalid time '+c);C+=w*Math.pow(60,g-y-1)}return 1e3*C}function getEpoch(c){if(!c)return 0;if('function'===typeof c.getTime)return c.getTime();if('number'===typeof c)return c;throw new TypeError('now should be milliseconds since UNIX epoch')}function inRange(c,d,g){return g&&g.callAt>=c&&g.callAt<=d}function mirrorDateProperties(c,d){for(var g in d)d.hasOwnProperty(g)&&(c[g]=d[g]);return d.now?c.now=function(){return c.clock.now}:delete c.now,d.toSource?c.toSource=function(){return d.toSource()}:delete c.toSource,c.toString=function(){return d.toString()},c.prototype=d.prototype,c.parse=d.parse,c.UTC=d.UTC,c.prototype.toUTCString=d.prototype.toUTCString,c}function createDate(){function c(d,g,y,C,w,A,E){switch(arguments.length){case 0:return new NativeDate(c.clock.now);case 1:return new NativeDate(d);case 2:return new NativeDate(d,g);case 3:return new NativeDate(d,g,y);case 4:return new NativeDate(d,g,y,C);case 5:return new NativeDate(d,g,y,C,w);case 6:return new NativeDate(d,g,y,C,w,A);default:return new NativeDate(d,g,y,C,w,A,E);}}return mirrorDateProperties(c,NativeDate)}function addTimer(c,d){if(void 0===d.func)throw new Error('Callback must be provided to timer calls');return c.timers||(c.timers={}),d.id=uniqueTimerId++,d.createdAt=c.now,d.callAt=c.now+(d.delay||(c.duringTick?1:0)),c.timers[d.id]=d,addTimerReturnsObject?{id:d.id,ref:NOOP,unref:NOOP}:d.id}function compareTimers(c,d){return c.callAt<d.callAt?-1:c.callAt>d.callAt?1:c.immediate&&!d.immediate?-1:!c.immediate&&d.immediate?1:c.createdAt<d.createdAt?-1:c.createdAt>d.createdAt?1:c.id<d.id?-1:c.id>d.id?1:void 0}function firstTimerInRange(c,d,g){var w,A,y=c.timers,C=null;for(w in y)y.hasOwnProperty(w)&&(A=inRange(d,g,y[w]),A&&(!C||1===compareTimers(C,y[w]))&&(C=y[w]));return C}function callTimer(clock,timer){var exception;'number'===typeof timer.interval?clock.timers[timer.id].callAt+=timer.interval:delete clock.timers[timer.id];try{'function'===typeof timer.func?timer.func.apply(null,timer.args):eval(timer.func)}catch(c){exception=c}if(!clock.timers[timer.id]){if(exception)throw exception;return}if(exception)throw exception}function timerType(c){return c.immediate?'Immediate':'undefined'===typeof c.interval?'Timeout':'Interval'}function clearTimer(c,d,g){if(d&&(c.timers||(c.timers=[]),'object'===typeof d&&(d=d.id),c.timers.hasOwnProperty(d))){var y=c.timers[d];if(timerType(y)===g)delete c.timers[d];else throw new Error('Cannot clear timer: timer created with set'+g+'() but cleared with clear'+timerType(y)+'()')}}function uninstall(c,d){var g,y,C;for(y=0,C=c.methods.length;y<C;y++)if(g=c.methods[y],d[g].hadOwnProperty)d[g]=c['_'+g];else try{delete d[g]}catch(w){}c.methods=[]}function hijackMethod(c,d,g){if(g[d].hadOwnProperty=Object.prototype.hasOwnProperty.call(c,d),g['_'+d]=c[d],'Date'===d){var C=mirrorDateProperties(g[d],c[d]);c[d]=C}else for(var y in c[d]=function(){return g[d].apply(g,arguments)},g[d])g[d].hasOwnProperty(y)&&(c[d][y]=g[d][y]);c[d].clock=g}function createClock(c){var d={now:getEpoch(c),timeouts:{},Date:createDate()};return d.Date.clock=d,d.setTimeout=function(y,C){return addTimer(d,{func:y,args:Array.prototype.slice.call(arguments,2),delay:C})},d.clearTimeout=function(y){return clearTimer(d,y,'Timeout')},d.setInterval=function(y,C){return addTimer(d,{func:y,args:Array.prototype.slice.call(arguments,2),delay:C,interval:C})},d.clearInterval=function(y){return clearTimer(d,y,'Interval')},d.setImmediate=function(y){return addTimer(d,{func:y,args:Array.prototype.slice.call(arguments,1),immediate:!0})},d.clearImmediate=function(y){return clearTimer(d,y,'Immediate')},d.tick=function(y){y='number'===typeof y?y:parseTime(y);var T,C=d.now,w=d.now+y,A=d.now,E=firstTimerInRange(d,C,w);d.duringTick=!0;for(var S;E&&C<=w;){if(d.timers[E.id]){C=d.now=E.callAt;try{T=d.now,callTimer(d,E),T!==d.now&&(C+=d.now-T,w+=d.now-T,A+=d.now-T)}catch(O){S=S||O}}E=firstTimerInRange(d,A,w),A=C}if(d.duringTick=!1,d.now=w,S)throw S;return d.now},d.reset=function(){d.timers={}},d.setSystemTime=function(y){var C=getEpoch(y),w=C-d.now;for(var A in d.now=C,d.timers)if(d.timers.hasOwnProperty(A)){var E=d.timers[A];E.createdAt+=w,E.callAt+=w}},d}var glbl=global;global.setTimeout=glbl.setTimeout,global.clearTimeout=glbl.clearTimeout,global.setInterval=glbl.setInterval,global.clearInterval=glbl.clearInterval,global.Date=glbl.Date,'setImmediate'in global&&(global.setImmediate=glbl.setImmediate,global.clearImmediate=glbl.clearImmediate);var NOOP=function(){},timeoutResult=setTimeout(NOOP,0),addTimerReturnsObject='object'===typeof timeoutResult;clearTimeout(timeoutResult);var NativeDate=Date,uniqueTimerId=1,timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:global.setImmediate,clearImmediate:global.clearImmediate,setInterval:setInterval,clearInterval:clearInterval,Date:Date},keys=Object.keys||function(c){var g,d=[];for(g in c)c.hasOwnProperty(g)&&d.push(g);return d};exports.timers=timers,exports.createClock=createClock,exports.install=function(d,g,y){var C,w;'number'===typeof d&&(y=g,g=d,d=null),d||(d=global);var A=createClock(g);for(A.uninstall=function(){uninstall(A,d)},A.methods=y||[],0===A.methods.length&&(A.methods=keys(timers)),(C=0,w=A.methods.length);C<w;C++)hijackMethod(d,A.methods[C],A);return A}})(global||this)}).call(this,'undefined'===typeof global?'undefined'===typeof self?'undefined'===typeof window?{}:window:self:global)},{}]},{},[1])(1)})})();var define,sinon=function(){'use strict';function c(C,w,A){d=A.exports=C('./sinon/util/core'),C('./sinon/extend'),C('./sinon/walk'),C('./sinon/typeOf'),C('./sinon/times_in_words'),C('./sinon/spy'),C('./sinon/call'),C('./sinon/behavior'),C('./sinon/stub'),C('./sinon/mock'),C('./sinon/collection'),C('./sinon/assert'),C('./sinon/sandbox'),C('./sinon/test'),C('./sinon/test_case'),C('./sinon/match'),C('./sinon/format'),C('./sinon/log_error')}var d,g='undefined'!==typeof module&&module.exports&&'function'===typeof require,y='function'===typeof define&&'object'===typeof define.amd&&define.amd;return y?define(c):g?(c(require,module.exports,module),d=module.exports):d={},d}();return function(c){function d(q){var N=!1;try{q.appendChild(S),N=S.parentNode===q}catch(D){return!1}finally{try{q.removeChild(S)}catch(D){}}return N}function g(q){return S&&q&&1===q.nodeType&&d(q)}function y(q){return'function'===typeof q||!!(q&&q.constructor&&q.call&&q.apply)}function C(q){return'number'===typeof q&&isNaN(q)}function w(q,N){for(var D in N)O.call(q,D)||(q[D]=N[D])}function A(q){return'function'===typeof q&&'function'===typeof q.restore&&q.restore.sinon}function E(q){return q.wrapMethod=function(D,L,M){function X(K){var z;if(!y(K))z=new TypeError('Attempted to wrap '+typeof K+' property '+L+' as function');else if(K.restore&&K.restore.sinon)z=new TypeError('Attempted to wrap '+L+' which is already wrapped');else if(K.calledBefore){var $=K.returns?'stubbed':'spied on';z=new TypeError('Attempted to wrap '+L+' which is already '+$)}if(z)throw K&&K.stackTrace&&(z.stack+='\n--------------\n'+K.stackTrace),z}if(!D)throw new TypeError('Should wrap property of object');if('function'!==typeof M&&'object'!==typeof M)throw new TypeError('Method wrapper should be a function or a property descriptor');var H,W,_,V=D.hasOwnProperty?D.hasOwnProperty(L):O.call(D,L);if(R){var B='function'===typeof M?{value:M}:M,U=q.getPropertyDescriptor(D,L);if(U?U.restore&&U.restore.sinon&&(H=new TypeError('Attempted to wrap '+L+' which is already wrapped')):H=new TypeError('Attempted to wrap '+typeof W+' property '+L+' as function'),H)throw U&&U.stackTrace&&(H.stack+='\n--------------\n'+U.stackTrace),H;var G=q.objectKeys(B);for(_=0;_<G.length;_++)W=U[G[_]],X(W);for(w(B,U),_=0;_<G.length;_++)w(B[G[_]],U[G[_]]);Object.defineProperty(D,L,B)}else W=D[L],X(W),D[L]=M,M.displayName=L;return M.displayName=L,M.stackTrace=new Error('Stack Trace for original').stack,M.restore=function(){if(!V)try{delete D[L]}catch(K){}else R&&Object.defineProperty(D,L,U);D[L]===M&&(D[L]=W)},M.restore.sinon=!0,R||w(M,W),M},q.create=function(D){var L=function(){};return L.prototype=D,new L},q.deepEqual=function N(D,L){if(q.match&&q.match.isMatcher(D))return D.test(L);if('object'!==typeof D||'object'!==typeof L)return C(D)&&C(L)||D===L;if(g(D)||g(L))return D===L;if(D===L)return!0;if(null===D&&null!==L||null!==D&&null===L)return!1;if(D instanceof RegExp&&L instanceof RegExp)return D.source===L.source&&D.global===L.global&&D.ignoreCase===L.ignoreCase&&D.multiline===L.multiline;var M=Object.prototype.toString.call(D);if(M!==Object.prototype.toString.call(L))return!1;if('[object Date]'===M)return D.valueOf()===L.valueOf();var X,H=0,W=0;if('[object Array]'===M&&D.length!==L.length)return!1;for(X in D)if(D.hasOwnProperty(X)){if(H+=1,!(X in L))return!1;if(!N(D[X],L[X]))return!1}for(X in L)L.hasOwnProperty(X)&&(W+=1);return H===W},q.functionName=function(D){var L=D.displayName||D.name;if(!L){var M=D.toString().match(/function ([^\s\(]+)/);L=M&&M[1]}return L},q.functionToString=function(){if(this.getCall&&this.callCount)for(var D,L,M=this.callCount;M--;)for(L in D=this.getCall(M).thisValue,D)if(D[L]===this)return L;return this.displayName||'sinon fake'},q.objectKeys=function(D){if(D!==Object(D))throw new TypeError('sinon.objectKeys called on a non-object');var M,L=[];for(M in D)O.call(D,M)&&L.push(M);return L},q.getPropertyDescriptor=function(D,L){for(var X,M=D;M&&!(X=Object.getOwnPropertyDescriptor(M,L));)M=Object.getPrototypeOf(M);return X},q.getConfig=function(N){var D={};N=N||{};var L=q.defaultConfig;for(var M in L)L.hasOwnProperty(M)&&(D[M]=N.hasOwnProperty(M)?N[M]:L[M]);return D},q.defaultConfig={injectIntoThis:!0,injectInto:null,properties:['spy','stub','mock','clock','server','requests'],useFakeTimers:!0,useFakeServer:!0},q.timesInWords=function(D){return 1===D&&'once'||2===D&&'twice'||3===D&&'thrice'||(D||0)+' times'},q.calledInOrder=function(N){for(var D=1,L=N.length;D<L;D++)if(!N[D-1].calledBefore(N[D])||!N[D].called)return!1;return!0},q.orderByFirstCall=function(N){return N.sort(function(D,L){var M=D.getCall(0),X=L.getCall(0),H=M&&M.callId||-1,W=X&&X.callId||-1;return H<W?-1:1})},q.createStubInstance=function(N){if('function'!==typeof N)throw new TypeError('The constructor should be a function.');return q.stub(q.create(N.prototype))},q.restore=function(N){if(null!==N&&'object'===typeof N)for(var D in N)A(N[D])&&N[D].restore();else A(N)&&N.restore()},q}function T(q,N){E(N)}var S='undefined'!==typeof document&&document.createElement('div'),O=Object.prototype.hasOwnProperty,R='keys'in Object,I='undefined'!==typeof module&&module.exports&&'function'===typeof require,P='function'===typeof define&&'object'===typeof define.amd&&define.amd;return P?void define(T):I?void T(require,module.exports,module):void(c&&E(c))}('object'===typeof sinon&&sinon),function(c){function d(w){var E=function(){var T={constructor:function(){return'0'},toString:function(){return'1'},valueOf:function(){return'2'},toLocaleString:function(){return'3'},prototype:function(){return'4'},isPrototypeOf:function(){return'5'},propertyIsEnumerable:function(){return'6'},hasOwnProperty:function(){return'7'},length:function(){return'8'},unique:function(){return'9'}},S=[];for(var O in T)T.hasOwnProperty(O)&&S.push(T[O]());return'0123456789'!==S.join('')}();return w.extend=function(T){var O,R,I,S=Array.prototype.slice.call(arguments,1);for(R=0;R<S.length;R++){for(I in O=S[R],O)O.hasOwnProperty(I)&&(T[I]=O[I]);E&&O.hasOwnProperty('toString')&&O.toString!==T.toString&&(T.toString=O.toString)}return T},w.extend}function g(w,A,E){var T=w('./util/core');E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(w){return w.timesInWords=function(E){return 1===E?'once':2===E?'twice':3===E?'thrice':(E||0)+' times'},w.timesInWords}function g(w,A,E){var T=w('./util/core');E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(w){return w.typeOf=function(E){if(null===E)return'null';if(void 0===E)return'undefined';var T=Object.prototype.toString.call(E);return T.substring(8,T.length-1).toLowerCase()},w.typeOf}function g(w,A,E){var T=w('./util/core');E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(w){function A(I,P,q){var N=w.typeOf(I);if(N!==P)throw new TypeError('Expected type of '+q+' to be '+P+', but was '+N)}function E(I){return R.isPrototypeOf(I)}function T(I,P){if(null===P||void 0===P)return!1;for(var q in I)if(I.hasOwnProperty(q)){var N=I[q],D=P[q];if(E(N)){if(!N.test(D))return!1;}else if('object'===w.typeOf(N)){if(!T(N,D))return!1;}else if(!w.deepEqual(N,D))return!1}return!0}function S(I,P){var q=w.create(R),N=w.typeOf(I);switch(N){case'object':if('function'===typeof I.test)return q.test=function(M){return!0===I.test(M)},q.message='match('+w.functionName(I.test)+')',q;var D=[];for(var L in I)I.hasOwnProperty(L)&&D.push(L+': '+I[L]);q.test=function(M){return T(I,M)},q.message='match('+D.join(', ')+')';break;case'number':q.test=function(M){return I==M};break;case'string':q.test=function(M){return'string'===typeof M&&-1!==M.indexOf(I)},q.message='match("'+I+'")';break;case'regexp':q.test=function(M){return'string'===typeof M&&I.test(M)};break;case'function':q.test=I,q.message=P?P:'match('+w.functionName(I)+')';break;default:q.test=function(M){return w.deepEqual(I,M)};}return q.message||(q.message='match('+I+')'),q}function O(I,P){return function(q,N){A(q,'string','property');var D=1===arguments.length,L=P+'("'+q+'"';return D||(L+=', '+N),L+=')',S(function(M){return void 0!==M&&null!==M&&I(M,q)&&(D||w.deepEqual(N,M[q]))},L)}}var R={toString:function(){return this.message}};return R.or=function(I){if(!arguments.length)throw new TypeError('Matcher expected');else E(I)||(I=S(I));var P=this,q=w.create(R);return q.test=function(N){return P.test(N)||I.test(N)},q.message=P.message+'.or('+I.message+')',q},R.and=function(I){if(!arguments.length)throw new TypeError('Matcher expected');else E(I)||(I=S(I));var P=this,q=w.create(R);return q.test=function(N){return P.test(N)&&I.test(N)},q.message=P.message+'.and('+I.message+')',q},S.isMatcher=E,S.any=S(function(){return!0},'any'),S.defined=S(function(I){return null!==I&&void 0!==I},'defined'),S.truthy=S(function(I){return!!I},'truthy'),S.falsy=S(function(I){return!I},'falsy'),S.same=function(I){return S(function(P){return I===P},'same('+I+')')},S.typeOf=function(I){return A(I,'string','type'),S(function(P){return w.typeOf(P)===I},'typeOf("'+I+'")')},S.instanceOf=function(I){return A(I,'function','type'),S(function(P){return P instanceof I},'instanceOf('+w.functionName(I)+')')},S.has=O(function(I,P){return'object'===typeof I?P in I:void 0!==I[P]},'has'),S.hasOwn=O(function(I,P){return I.hasOwnProperty(P)},'hasOwn'),S.bool=S.typeOf('boolean'),S.number=S.typeOf('number'),S.string=S.typeOf('string'),S.object=S.typeOf('object'),S.func=S.typeOf('function'),S.array=S.typeOf('array'),S.regexp=S.typeOf('regexp'),S.date=S.typeOf('date'),w.match=S,S}function g(w,A,E){var T=w('./util/core');w('./typeOf'),E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c,d){function g(A){function E(I){return''+I}var R,O='undefined'!==typeof module&&module.exports&&'function'===typeof require;if(O)try{d=require('formatio')}catch(I){}return R=d?function(){var P=d.configure({quoteStrings:!1,limitChildrenCount:250});return function(){return P.ascii.apply(P,arguments)}}():O?function(){try{var P=require('util')}catch(q){}return P?function(q){var N='object'===typeof q&&q.toString===Object.prototype.toString;return N?P.inspect(q):q}:E}():E,A.format=R,A.format}function y(A,E,T){var S=A('./util/core');T.exports=g(S)}var C='undefined'!==typeof module&&module.exports&&'function'===typeof require,w='function'===typeof define&&'object'===typeof define.amd&&define.amd;return w?void define(y):C?void y(require,module.exports,module):void(c&&g(c))}('object'===typeof sinon&&sinon,'object'===typeof formatio&&formatio),function(c){function d(A){function E(O,R,I){var P=A.functionName(O)+R;throw I.length&&(P+=' Received ['+y.call(I).join(', ')+']'),new Error(P)}function T(O,R,I,P,q,N,D){if('number'!==typeof N)throw new TypeError('Call id is not a number');var L=A.create(S);return L.proxy=O,L.thisValue=R,L.args=I,L.returnValue=P,L.exception=q,L.callId=N,L.stack=D,L}var S={calledOn:function(R){return A.match&&A.match.isMatcher(R)?R.test(this.thisValue):this.thisValue===R},calledWith:function(){var R=arguments.length;if(R>this.args.length)return!1;for(var I=0;I<R;I+=1)if(!A.deepEqual(arguments[I],this.args[I]))return!1;return!0},calledWithMatch:function(){var R=arguments.length;if(R>this.args.length)return!1;for(var I=0;I<R;I+=1){var P=this.args[I],q=arguments[I];if(!A.match||!A.match(q).test(P))return!1}return!0},calledWithExactly:function(){return arguments.length===this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(R){return A.deepEqual(R,this.returnValue)},threw:function(R){return'undefined'!==typeof R&&this.exception?this.exception===R||this.exception.name===R:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(O){return this.callId<O.callId},calledAfter:function(O){return this.callId>O.callId},callArg:function(O){this.args[O]()},callArgOn:function(O,R){this.args[O].apply(R)},callArgWith:function(O){this.callArgOnWith.apply(this,[O,null].concat(y.call(arguments,1)))},callArgOnWith:function(O,R){var I=y.call(arguments,2);this.args[O].apply(R,I)},'yield':function(){this.yieldOn.apply(this,[null].concat(y.call(arguments,0)))},yieldOn:function(O){for(var R=this.args,I=0,P=R.length;I<P;++I)if('function'===typeof R[I])return void R[I].apply(O,y.call(arguments,1));E(this.proxy,' cannot yield since no callback was passed.',R)},yieldTo:function(O){this.yieldToOn.apply(this,[O,null].concat(y.call(arguments,1)))},yieldToOn:function(O,R){for(var I=this.args,P=0,q=I.length;P<q;++P)if(I[P]&&'function'===typeof I[P][O])return void I[P][O].apply(R,y.call(arguments,2));E(this.proxy,' cannot yield to \''+O+'\' since no callback was passed.',I)},getStackFrames:function(){return this.stack&&this.stack.split('\n').slice(3)},toString:function(){for(var O=this.proxy.toString()+'(',R=[],I=0,P=this.args.length;I<P;++I)R.push(A.format(this.args[I]));return O=O+R.join(', ')+')','undefined'!==typeof this.returnValue&&(O+=' => '+A.format(this.returnValue)),this.exception&&(O+=' !'+this.exception.name,this.exception.message&&(O+='('+this.exception.message+')')),this.stack&&(O+=this.getStackFrames()[0].replace(/^\s*(?:at\s+|@)?/,' at ')),O}};return S.invokeCallback=S.yield,T.toString=S.toString,A.spyCall=T,T}function g(A,E,T){var S=A('./util/core');A('./match'),A('./format'),T.exports=d(S)}var y=Array.prototype.slice,C='undefined'!==typeof module&&module.exports&&'function'===typeof require,w='function'===typeof define&&'object'===typeof define.amd&&define.amd;return w?void define(g):C?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(sinonGlobal){function makeApi(sinon){function spy(c,d,g){if(!d&&'function'===typeof c)return spy.create(c);if(!c&&!d)return spy.create(function(){});if(g){for(var y=sinon.getPropertyDescriptor(c,d),C=0;C<g.length;C++)y[g[C]]=spy.create(y[g[C]]);return sinon.wrapMethod(c,d,y)}return sinon.wrapMethod(c,d,spy.create(c[d]))}function matchingFake(c,d,g){if(c)for(var y=0,C=c.length;y<C;y++)if(c[y].matches(d,g))return c[y]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1===this.callCount,this.calledTwice=2===this.callCount,this.calledThrice=3===this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1)}function createProxy(func,proxyLength){var p;return proxyLength?eval('p = (function proxy('+vars.substring(0,2*proxyLength-1)+') { return p.invoke(func, this, slice.call(arguments)); });'):p=function(){return p.invoke(func,this,slice.call(arguments))},p.isSinonProxy=!0,p}function delegateToCalls(c,d,g,y){spyApi[c]=function(){if(!this.called)return!!y&&y.apply(this,arguments);for(var C,w=0,A=0,E=this.callCount;A<E;A+=1)if(C=this.getCall(A),C[g||c].apply(C,arguments)&&(w+=1,d))return!0;return w===this.callCount}}var push=Array.prototype.push,slice=Array.prototype.slice,callId=0,vars='a,b,c,d,e,f,g,h,i,j,k,l',uuid=0,spyApi={reset:function(){if(this.invoking){var c=new Error('Cannot reset Sinon function while invoking it. Move the call to .reset outside of the callback.');throw c.name='InvalidResetException',c}if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.stacks=[],this.fakes)for(var d=0;d<this.fakes.length;d++)this.fakes[d].reset();return this},create:function(d,g){var y;'function'===typeof d?y=sinon.functionName(d):d=function(){},g||(g=d.length);var C=createProxy(d,g);return sinon.extend(C,spy),delete C.create,sinon.extend(C,d),C.reset(),C.prototype=d.prototype,C.displayName=y||'spy',C.toString=sinon.functionToString,C.instantiateFake=sinon.spy.create,C.id='spy#'+uuid++,C},invoke:function(d,g,y){var w,A,C=matchingFake(this.fakes,y);incrementCallCount.call(this),push.call(this.thisValues,g),push.call(this.args,y),push.call(this.callIds,callId++),createCallProperties.call(this);try{this.invoking=!0,A=C?C.invoke(d,g,y):(this.func||d).apply(g,y);var E=this.getCall(this.callCount-1);E.calledWithNew()&&'object'!==typeof A&&(A=g)}catch(T){w=T}finally{delete this.invoking}if(push.call(this.exceptions,w),push.call(this.returnValues,A),push.call(this.stacks,new Error().stack),createCallProperties.call(this),void 0!==w)throw w;return A},named:function(d){return this.displayName=d,this},getCall:function(d){return 0>d||d>=this.callCount?null:sinon.spyCall(this,this.thisValues[d],this.args[d],this.returnValues[d],this.exceptions[d],this.callIds[d],this.stacks[d])},getCalls:function(){var d,c=[];for(d=0;d<this.callCount;d++)c.push(this.getCall(d));return c},calledBefore:function(d){return!!this.called&&(!d.called||this.callIds[0]<d.callIds[d.callIds.length-1])},calledAfter:function(d){return this.called&&d.called&&this.callIds[this.callCount-1]>d.callIds[d.callCount-1]},withArgs:function(){var c=slice.call(arguments);if(this.fakes){var d=matchingFake(this.fakes,c,!0);if(d)return d}else this.fakes=[];var g=this,y=this.instantiateFake();y.matchingAguments=c,y.parent=this,push.call(this.fakes,y),y.withArgs=function(){return g.withArgs.apply(g,arguments)};for(var C=0;C<this.args.length;C++)y.matches(this.args[C])&&(incrementCallCount.call(y),push.call(y.thisValues,this.thisValues[C]),push.call(y.args,this.args[C]),push.call(y.returnValues,this.returnValues[C]),push.call(y.exceptions,this.exceptions[C]),push.call(y.callIds,this.callIds[C]));return createCallProperties.call(y),y},matches:function(c,d){var g=this.matchingAguments;if(g.length<=c.length&&sinon.deepEqual(g,c.slice(0,g.length)))return!d||g.length===c.length},printf:function(c){var y,d=this,g=slice.call(arguments,1);return(c||'').replace(/%(.)/g,function(C,w){return(y=spyApi.formatters[w],'function'===typeof y)?y.call(null,d,g):isNaN(parseInt(w,10))?'%'+w:sinon.format(g[w-1])})}};return delegateToCalls('calledOn',!0),delegateToCalls('alwaysCalledOn',!1,'calledOn'),delegateToCalls('calledWith',!0),delegateToCalls('calledWithMatch',!0),delegateToCalls('alwaysCalledWith',!1,'calledWith'),delegateToCalls('alwaysCalledWithMatch',!1,'calledWithMatch'),delegateToCalls('calledWithExactly',!0),delegateToCalls('alwaysCalledWithExactly',!1,'calledWithExactly'),delegateToCalls('neverCalledWith',!1,'notCalledWith',function(){return!0}),delegateToCalls('neverCalledWithMatch',!1,'notCalledWithMatch',function(){return!0}),delegateToCalls('threw',!0),delegateToCalls('alwaysThrew',!1,'threw'),delegateToCalls('returned',!0),delegateToCalls('alwaysReturned',!1,'returned'),delegateToCalls('calledWithNew',!0),delegateToCalls('alwaysCalledWithNew',!1,'calledWithNew'),delegateToCalls('callArg',!1,'callArgWith',function(){throw new Error(this.toString()+' cannot call arg since it was not yet invoked.')}),spyApi.callArgWith=spyApi.callArg,delegateToCalls('callArgOn',!1,'callArgOnWith',function(){throw new Error(this.toString()+' cannot call arg since it was not yet invoked.')}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls('yield',!1,'yield',function(){throw new Error(this.toString()+' cannot yield since it was not yet invoked.')}),spyApi.invokeCallback=spyApi.yield,delegateToCalls('yieldOn',!1,'yieldOn',function(){throw new Error(this.toString()+' cannot yield since it was not yet invoked.')}),delegateToCalls('yieldTo',!1,'yieldTo',function(c){throw new Error(this.toString()+' cannot yield to \''+c+'\' since it was not yet invoked.')}),delegateToCalls('yieldToOn',!1,'yieldToOn',function(c){throw new Error(this.toString()+' cannot yield to \''+c+'\' since it was not yet invoked.')}),spyApi.formatters={c:function(c){return sinon.timesInWords(c.callCount)},n:function(c){return c.toString()},C:function(c){for(var C,d=[],g=0,y=c.callCount;g<y;++g)C='    '+c.getCall(g).toString(),/\n/.test(d[g-1])&&(C='\n'+C),push.call(d,C);return 0<d.length?'\n'+d.join('\n'):''},t:function(c){for(var d=[],g=0,y=c.callCount;g<y;++g)push.call(d,sinon.format(c.thisValues[g]));return d.join(', ')},'*':function(c,d){for(var g=[],y=0,C=d.length;y<C;++y)push.call(g,sinon.format(d[y]));return g.join(', ')}},sinon.extend(spy,spyApi),spy.spyCall=sinon.spyCall,sinon.spy=spy,spy}function loadDependencies(c,d,g){var y=c('./util/core');c('./call'),c('./extend'),c('./times_in_words'),c('./format'),g.exports=makeApi(y)}var isNode='undefined'!==typeof module&&module.exports&&'function'===typeof require,isAMD='function'===typeof define&&'object'===typeof define.amd&&define.amd;return isAMD?void define(loadDependencies):isNode?void loadDependencies(require,module.exports,module):void(sinonGlobal&&makeApi(sinonGlobal))}('object'===typeof sinon&&sinon),function(c){function d(I,P){return'string'===typeof I?(this.exception=new Error(P||''),this.exception.name=I):I?this.exception=I:this.exception=new Error('Error'),this}function g(I,P){var q=I.callArgAt;if(0<=q)return P[q];var N;q===E&&(N=P),q===T&&(N=w.call(P).reverse());for(var D=I.callArgProp,L=0,M=N.length;L<M;++L){if(!D&&'function'===typeof N[L])return N[L];if(D&&N[L]&&'function'===typeof N[L][D])return N[L][D]}return null}function y(I){function P(M,X,H){if(0>M.callArgAt){var W;return W=M.callArgProp?I.functionName(M.stub)+' expected to yield to \''+M.callArgProp+'\', but no object with such a property was passed.':I.functionName(M.stub)+' expected to yield, but no callback was passed.',0<H.length&&(W+=' Received ['+A.call(H,', ')+']'),W}return'argument at index '+M.callArgAt+' is not a function: '+X}function q(M,X){if('number'===typeof M.callArgAt){var H=g(M,X);if('function'!==typeof H)throw new TypeError(P(M,H,X));M.callbackAsync?S(function(){H.apply(M.callbackContext,M.callbackArguments)}):H.apply(M.callbackContext,M.callbackArguments)}}function N(M){return function(){var X=this[M].apply(this,arguments);return this.callbackAsync=!0,X}}var D={create:function(X){var H=I.extend({},I.behavior);return delete H.create,H.stub=X,H},isPresent:function(){return'number'===typeof this.callArgAt||this.exception||'number'===typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(X,H){if(q(this,H),this.exception)throw this.exception;else{if('number'===typeof this.returnArgAt)return H[this.returnArgAt];if(this.returnThis)return X}return this.returnValue},onCall:function(X){return this.stub.onCall(X)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw new Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.')},callsArg:function(X){if('number'!==typeof X)throw new TypeError('argument index is not number');return this.callArgAt=X,this.callbackArguments=[],this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOn:function(X,H){if('number'!==typeof X)throw new TypeError('argument index is not number');if('object'!==typeof H)throw new TypeError('argument context is not an object');return this.callArgAt=X,this.callbackArguments=[],this.callbackContext=H,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgWith:function(X){if('number'!==typeof X)throw new TypeError('argument index is not number');return this.callArgAt=X,this.callbackArguments=w.call(arguments,1),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOnWith:function(X,H){if('number'!==typeof X)throw new TypeError('argument index is not number');if('object'!==typeof H)throw new TypeError('argument context is not an object');return this.callArgAt=X,this.callbackArguments=w.call(arguments,2),this.callbackContext=H,this.callArgProp=void 0,this.callbackAsync=!1,this},yields:function(){return this.callArgAt=E,this.callbackArguments=w.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsRight:function(){return this.callArgAt=T,this.callbackArguments=w.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsOn:function(M){if('object'!==typeof M)throw new TypeError('argument context is not an object');return this.callArgAt=E,this.callbackArguments=w.call(arguments,1),this.callbackContext=M,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsTo:function(M){return this.callArgAt=E,this.callbackArguments=w.call(arguments,1),this.callbackContext=void 0,this.callArgProp=M,this.callbackAsync=!1,this},yieldsToOn:function(M,X){if('object'!==typeof X)throw new TypeError('argument context is not an object');return this.callArgAt=E,this.callbackArguments=w.call(arguments,2),this.callbackContext=X,this.callArgProp=M,this.callbackAsync=!1,this},throws:d,throwsException:d,returns:function(X){return this.returnValue=X,this.returnValueDefined=!0,this.exception=void 0,this},returnsArg:function(X){if('number'!==typeof X)throw new TypeError('argument index is not number');return this.returnArgAt=X,this},returnsThis:function(){return this.returnThis=!0,this}};for(var L in D)D.hasOwnProperty(L)&&L.match(/^(callsArg|yields)/)&&!L.match(/Async/)&&(D[L+'Async']=N(L));return I.behavior=D,D}function C(I,P,q){var N=I('./util/core');I('./extend'),q.exports=y(N)}var w=Array.prototype.slice,A=Array.prototype.join,E=-1,T=-2,S=function(){return'object'===typeof process&&'function'===typeof process.nextTick?process.nextTick:'function'===typeof setImmediate?setImmediate:function(I){setTimeout(I,0)}}(),O='undefined'!==typeof module&&module.exports&&'function'===typeof require,R='function'===typeof define&&'object'===typeof define.amd&&define.amd;return R?void define(C):O?void C(require,module.exports,module):void(c&&y(c))}('object'===typeof sinon&&sinon),function(c){function d(w){function A(T,S,O,R){var I,P;if('function'!==typeof Object.getOwnPropertyNames){for(P in T)S.call(O,T[P],P,T);return}Object.getOwnPropertyNames(T).forEach(function(q){var N='function'===typeof Object.getOwnPropertyDescriptor(T,q).get?R:T;S.call(O,N[q],q,N)}),I=Object.getPrototypeOf(T),I&&A(I,S,O,R)}return w.walk=function(T,S,O){return A(T,S,O,T)},w.walk}function g(w,A,E){var T=w('./util/core');E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(w){function A(q,N,D){if(!!D&&'function'!==typeof D&&'object'!==typeof D)throw new TypeError('Custom stub should be a function or a property descriptor');var L;if(!D){var H=0;'object'===typeof q&&'function'===typeof q[N]&&(H=q[N].length),L=A.create(H)}else if('function'===typeof D)L=w.spy&&w.spy.create?w.spy.create(D):D;else if(L=D,w.spy&&w.spy.create)for(var M=w.objectKeys(L),X=0;X<M.length;X++)L[M[X]]=w.spy.create(L[M[X]]);return q||'undefined'!==typeof N?'undefined'===typeof N&&'object'===typeof q?(w.walk(q||{},function(W,_,V){V!==Object.prototype&&'constructor'!==_&&'function'===typeof w.getPropertyDescriptor(V,_).value&&A(q,_)}),q):w.wrapMethod(q,N,L):w.stub.create()}function E(q){return q.parent&&S(q.parent)}function T(q){return q.defaultBehavior||E(q)||w.behavior.create(q)}function S(q){var N=q.behaviors[q.callCount-1];return N&&N.isPresent()?N:T(q)}function O(q){return function(){return this.defaultBehavior=this.defaultBehavior||w.behavior.create(this),this.defaultBehavior[q].apply(this.defaultBehavior,arguments),this}}var R=0,I={create:function(N){var D=function(){return S(D).invoke(this,arguments)};D.id='stub#'+R++;var L=D;return D=w.spy.create(D,N),D.func=L,w.extend(D,A),D.instantiateFake=w.stub.create,D.displayName='stub',D.toString=w.functionToString,D.defaultBehavior=null,D.behaviors=[],D},resetBehavior:function(){var q;if(this.defaultBehavior=null,this.behaviors=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(q=0;q<this.fakes.length;q++)this.fakes[q].resetBehavior()},onCall:function(N){return this.behaviors[N]||(this.behaviors[N]=w.behavior.create(this)),this.behaviors[N]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},onThirdCall:function(){return this.onCall(2)}};for(var P in w.behavior)w.behavior.hasOwnProperty(P)&&!I.hasOwnProperty(P)&&'create'!==P&&'withArgs'!==P&&'invoke'!==P&&(I[P]=O(P));return w.extend(A,I),w.stub=A,A}function g(w,A,E){var T=w('./util/core');w('./behavior'),w('./spy'),w('./extend'),E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(w){function A(M){return M?A.create(M):w.expectation.create('Anonymous mock')}function E(M,X){if(M)for(var H=0,W=M.length;H<W;H+=1)X(M[H])}function T(M,X,H){if(H&&M.length!==X.length)return!1;for(var W=0,_=M.length;W<_;W++)if(!w.deepEqual(M[W],X[W]))return!1;return!0}function S(M){return 0===M?'never called':'called '+D(M)}function O(M){var X=M.minCalls,H=M.maxCalls;if('number'===typeof X&&'number'===typeof H){var W=D(X);return X!==H&&(W='at least '+W+' and at most '+D(H)),W}return'number'===typeof X?'at least '+D(X):'at most '+D(H)}function R(M){var X='number'===typeof M.minCalls;return!X||M.callCount>=M.minCalls}function I(M){return'number'===typeof M.maxCalls&&M.callCount===M.maxCalls}function P(M,X){var H=N&&N.isMatcher(M);return H&&M.test(X)||!0}var q=[].push,N=w.match;w.extend(A,{create:function(X){if(!X)throw new TypeError('object is null');var H=w.extend({},A);return H.object=X,delete H.create,H},expects:function(X){if(!X)throw new TypeError('method is falsy');if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[X]){this.expectations[X]=[];var H=this;w.wrapMethod(this.object,X,function(){return H.invokeMethod(X,this,arguments)}),q.call(this.proxies,X)}var W=w.expectation.create(X);return q.call(this.expectations[X],W),W},restore:function(){var X=this.object;E(this.proxies,function(H){'function'===typeof X[H].restore&&X[H].restore()})},verify:function(){var X=this.expectations||{},H=[],W=[];return E(this.proxies,function(_){E(X[_],function(V){V.met()?q.call(W,V.toString()):q.call(H,V.toString())})}),this.restore(),0<H.length?w.expectation.fail(H.concat(W).join('\n')):0<W.length&&w.expectation.pass(H.concat(W).join('\n')),!0},invokeMethod:function(X,H,W){var U,G,_=this.expectations&&this.expectations[X]?this.expectations[X]:[],V=[],B=W||[];for(U=0;U<_.length;U+=1){var K=_[U].expectedArguments||[];T(K,B,_[U].expectsExactArgCount)&&V.push(_[U])}for(U=0;U<V.length;U+=1)if(!V[U].met()&&V[U].allowsCall(H,W))return V[U].apply(H,W);var z=[],$=0;for(U=0;U<V.length;U+=1)V[U].allowsCall(H,W)?G=G||V[U]:$+=1;if(G&&0===$)return G.apply(H,W);for(U=0;U<_.length;U+=1)q.call(z,'    '+_[U].toString());z.unshift('Unexpected call: '+w.spyCall.toString.call({proxy:X,args:W})),w.expectation.fail(z.join('\n'))}});var D=w.timesInWords,L=Array.prototype.slice;return w.expectation={minCalls:1,maxCalls:1,create:function(X){var H=w.extend(w.stub.create(),w.expectation);return delete H.create,H.method=X,H},invoke:function(X,H,W){return this.verifyCallAllowed(H,W),w.spy.invoke.apply(this,arguments)},atLeast:function(X){if('number'!==typeof X)throw new TypeError('\''+X+'\' is not number');return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=X,this},atMost:function(X){if('number'!==typeof X)throw new TypeError('\''+X+'\' is not number');return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=X,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(X){if('number'!==typeof X)throw new TypeError('\''+X+'\' is not a number');return this.atLeast(X),this.atMost(X)},met:function(){return!this.failed&&R(this)},verifyCallAllowed:function(X,H){if(I(this)&&(this.failed=!0,w.expectation.fail(this.method+' already called '+D(this.maxCalls))),'expectedThis'in this&&this.expectedThis!==X&&w.expectation.fail(this.method+' called with '+X+' as thisValue, expected '+this.expectedThis),!!('expectedArguments'in this)){H||w.expectation.fail(this.method+' received no arguments, expected '+w.format(this.expectedArguments)),H.length<this.expectedArguments.length&&w.expectation.fail(this.method+' received too few arguments ('+w.format(H)+'), expected '+w.format(this.expectedArguments)),this.expectsExactArgCount&&H.length!==this.expectedArguments.length&&w.expectation.fail(this.method+' received too many arguments ('+w.format(H)+'), expected '+w.format(this.expectedArguments));for(var W=0,_=this.expectedArguments.length;W<_;W+=1)P(this.expectedArguments[W],H[W])||w.expectation.fail(this.method+' received wrong arguments '+w.format(H)+', didn\'t match '+this.expectedArguments.toString()),w.deepEqual(this.expectedArguments[W],H[W])||w.expectation.fail(this.method+' received wrong arguments '+w.format(H)+', expected '+w.format(this.expectedArguments))}},allowsCall:function(X,H){if(this.met()&&I(this))return!1;if('expectedThis'in this&&this.expectedThis!==X)return!1;if(!('expectedArguments'in this))return!0;if(H=H||[],H.length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&H.length!==this.expectedArguments.length)return!1;for(var W=0,_=this.expectedArguments.length;W<_;W+=1){if(!P(this.expectedArguments[W],H[W]))return!1;if(!w.deepEqual(this.expectedArguments[W],H[W]))return!1}return!0},withArgs:function(){return this.expectedArguments=L.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(X){return this.expectedThis=X,this},toString:function(){var M=(this.expectedArguments||[]).slice();this.expectsExactArgCount||q.call(M,'[...]');var X=w.spyCall.toString.call({proxy:this.method||'anonymous mock expectation',args:M}),H=X.replace(', [...','[, ...')+' '+O(this);return this.met()?'Expectation met: '+H:'Expected '+H+' ('+S(this.callCount)+')'},verify:function(){return this.met()?w.expectation.pass(this.toString()):w.expectation.fail(this.toString()),!0},pass:function(X){w.assert.pass(X)},fail:function(X){var H=new Error(X);throw H.name='ExpectationError',H}},w.mock=A,A}function g(w,A,E){var T=w('./util/core');w('./times_in_words'),w('./call'),w('./extend'),w('./match'),w('./spy'),w('./stub'),w('./format'),E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(O){return O.fakes||(O.fakes=[]),O.fakes}function g(O,R){for(var I=d(O),P=0,q=I.length;P<q;P+=1)'function'===typeof I[P][R]&&I[P][R]()}function y(O){for(var R=d(O),I=0;I<R.length;)R.splice(I,1)}function C(O){var R={verify:function(){g(this,'verify')},restore:function(){g(this,'restore'),y(this)},reset:function(){g(this,'reset')},verifyAndRestore:function(){var P;try{this.verify()}catch(q){P=q}if(this.restore(),P)throw P},add:function(P){return A.call(d(this),P),P},spy:function(){return this.add(O.spy.apply(O,arguments))},stub:function(P,q,N){if(q){var D=P[q];if('function'!==typeof D){if(!E.call(P,q))throw new TypeError('Cannot stub non-existent own property '+q);return P[q]=N,this.add({restore:function(){P[q]=D}})}}if(!q&&!!P&&'object'===typeof P){var L=O.stub.apply(O,arguments);for(var M in L)'function'===typeof L[M]&&this.add(L[M]);return L}return this.add(O.stub.apply(O,arguments))},mock:function(){return this.add(O.mock.apply(O,arguments))},inject:function(P){var q=this;return P.spy=function(){return q.spy.apply(q,arguments)},P.stub=function(){return q.stub.apply(q,arguments)},P.mock=function(){return q.mock.apply(q,arguments)},P}};return O.collection=R,R}function w(O,R,I){var P=O('./util/core');O('./mock'),O('./spy'),O('./stub'),I.exports=C(P)}var A=[].push,E=Object.prototype.hasOwnProperty,T='undefined'!==typeof module&&module.exports&&'function'===typeof require,S='function'===typeof define&&'object'===typeof define.amd&&define.amd;return S?void define(w):T?void w(require,module.exports,module):void(c&&C(c))}('object'===typeof sinon&&sinon),function(){function c(C,w){var A='undefined'===typeof lolex?w:lolex;C.useFakeTimers=function(){var E,T=Array.prototype.slice.call(arguments);E='string'===typeof T[0]?0:T.shift();var S=A.install(E||0,T);return S.restore=S.uninstall,S},C.clock={create:function(E){return A.createClock(E)}},C.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:'undefined'===typeof setImmediate?void 0:setImmediate,clearImmediate:'undefined'===typeof clearImmediate?void 0:clearImmediate,setInterval:setInterval,clearInterval:clearInterval,Date:Date}}function d(C,w,A,E){var T=C('./core');c(T,E),A.exports=T}var g='undefined'!==typeof module&&module.exports&&'function'===typeof require,y='function'===typeof define&&'object'===typeof define.amd&&define.amd;y?define(d):g?d(require,module.exports,module,require('lolex')):c(sinon)}(),'undefined'===typeof sinon&&(this.sinon={}),function(){function c(w){w.Event=function(E,T,S,O){this.initEvent(E,T,S,O)},w.Event.prototype={initEvent:function(A,E,T,S){this.type=A,this.bubbles=E,this.cancelable=T,this.target=S},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},w.ProgressEvent=function(E,T,S){this.initEvent(E,!1,!1,S),this.loaded=T.loaded||null,this.total=T.total||null,this.lengthComputable=!!T.total},w.ProgressEvent.prototype=new w.Event,w.ProgressEvent.prototype.constructor=w.ProgressEvent,w.CustomEvent=function(E,T,S){this.initEvent(E,!1,!1,S),this.detail=T.detail||null},w.CustomEvent.prototype=new w.Event,w.CustomEvent.prototype.constructor=w.CustomEvent,w.EventTarget={addEventListener:function(E,T){this.eventListeners=this.eventListeners||{},this.eventListeners[E]=this.eventListeners[E]||[],g.call(this.eventListeners[E],T)},removeEventListener:function(E,T){for(var S=this.eventListeners&&this.eventListeners[E]||[],O=0,R=S.length;O<R;++O)if(S[O]===T)return S.splice(O,1)},dispatchEvent:function(E){for(var T=E.type,S=this.eventListeners&&this.eventListeners[T]||[],O=0;O<S.length;O++)'function'===typeof S[O]?S[O].call(this,E):S[O].handleEvent(E);return!!E.defaultPrevented}}}function d(w){var A=w('./core');c(A)}var g=[].push,y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;C?define(d):y?d(require):c(sinon)}(),function(c){function d(A){function T(O,R){function I(){throw R.message=P+R.message,R}var P=O+' threw exception: ';A.log(P+'['+R.name+'] '+R.message),R.stack&&A.log(R.stack),T.useImmediateExceptions?I():T.setTimeout(I,0)}T.useImmediateExceptions=!1,T.setTimeout=function(O,R){y(O,R)};var S={log:A.log=function(){},logError:A.logError=T};return S}function g(A,E,T){var S=A('./util/core');T.exports=d(S)}var y=setTimeout,C='undefined'!==typeof module&&module.exports&&'function'===typeof require,w='function'===typeof define&&'object'===typeof define.amd&&define.amd;return w?void define(g):C?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),'undefined'===typeof sinon&&(this.sinon={}),function(c){function d(A){function E(){this.readyState=E.UNSENT,this.requestBody=null,this.requestHeaders={},this.status=0,this.timeout=null,'function'===typeof E.onCreate&&E.onCreate(this)}function T(R){if(R.readyState!==E.OPENED)throw new Error('INVALID_STATE_ERR');if(R.sendFlag)throw new Error('INVALID_STATE_ERR')}function S(R){if(R.readyState===E.UNSENT)throw new Error('Request not sent');if(R.readyState===E.DONE)throw new Error('Request done')}function O(R){if('string'!==typeof R){var I=new Error('Attempted to respond to fake XDomainRequest with '+R+', which is not a string.');throw I.name='InvalidBodyException',I}}A.xdr=y,A.extend(E.prototype,A.EventTarget,{open:function(I,P){this.method=I,this.url=P,this.responseText=null,this.sendFlag=!1,this.readyStateChange(E.OPENED)},readyStateChange:function(I){this.readyState=I;var P='';switch(this.readyState){case E.UNSENT:break;case E.OPENED:break;case E.LOADING:this.sendFlag&&(P='onprogress');break;case E.DONE:P=this.isTimeout?'ontimeout':this.errorFlag||200>this.status||299<this.status?'onerror':'onload';}if(P&&'function'===typeof this[P])try{this[P]()}catch(q){A.logError('Fake XHR '+P+' handler',q)}},send:function(I){T(this),/^(get|head)$/i.test(this.method)||(this.requestBody=I),this.requestHeaders['Content-Type']='text/plain;charset=utf-8',this.errorFlag=!1,this.sendFlag=!0,this.readyStateChange(E.OPENED),'function'===typeof this.onSend&&this.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.readyState>A.FakeXDomainRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(A.FakeXDomainRequest.DONE),this.sendFlag=!1)},setResponseBody:function(I){S(this),O(I);var P=this.chunkSize||10,q=0;this.responseText='';do this.readyStateChange(E.LOADING),this.responseText+=I.substring(q,q+P),q+=P;while(q<I.length);this.readyStateChange(E.DONE)},respond:function(I,P,q){this.status='number'===typeof I?I:200,this.setResponseBody(q||'')},simulatetimeout:function(){this.status=0,this.isTimeout=!0,this.responseText=void 0,this.readyStateChange(E.DONE)}}),A.extend(E,{UNSENT:0,OPENED:1,LOADING:3,DONE:4}),A.useFakeXDomainRequest=function(){return A.FakeXDomainRequest.restore=function(P){y.supportsXDR&&(c.XDomainRequest=y.GlobalXDomainRequest),delete A.FakeXDomainRequest.restore,!0!==P&&delete A.FakeXDomainRequest.onCreate},y.supportsXDR&&(c.XDomainRequest=A.FakeXDomainRequest),A.FakeXDomainRequest},A.FakeXDomainRequest=E}function g(A,E,T){var S=A('./core');A('../extend'),A('./event'),A('../log_error'),d(S),T.exports=S}var y={XDomainRequest:c.XDomainRequest};y.GlobalXDomainRequest=c.XDomainRequest,y.supportsXDR='undefined'!==typeof y.GlobalXDomainRequest,y.workingXDR=!!y.supportsXDR&&y.GlobalXDomainRequest;var C='undefined'!==typeof module&&module.exports&&'function'===typeof require,w='function'===typeof define&&'object'===typeof define.amd&&define.amd;w?define(g):C?g(require,module.exports,module):d(sinon)}('undefined'===typeof global?self:global),function(c,d){function y(){this.eventListeners={progress:[],load:[],abort:[],error:[]}}function C(){function Z(ee){J.addEventListener(ee,function(te){var ne=J['on'+ee];ne&&'function'===typeof ne&&ne.call(this,te)})}this.readyState=C.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText='',this.upload=new y,this.responseType='',this.response='',B.supportsCORS&&(this.withCredentials=!1);for(var J=this,Y=['loadstart','load','abort','loadend'],Q=Y.length-1;0<=Q;Q--)Z(Y[Q]);'function'===typeof C.onCreate&&C.onCreate(this)}function w(Z){if(Z.readyState!==C.OPENED)throw new Error('INVALID_STATE_ERR');if(Z.sendFlag)throw new Error('INVALID_STATE_ERR')}function A(Z,J){for(var Y in J=J.toLowerCase(),Z)if(Y.toLowerCase()===J)return Y;return null}function E(Z,J){if(Z)for(var Y=0,Q=Z.length;Y<Q;Y+=1)J(Z[Y])}function T(Z,J){for(var Y=0;Y<Z.length;Y++)if(!0===J(Z[Y]))return!0;return!1}function S(Z){if(Z.readyState!==C.OPENED)throw new Error('INVALID_STATE_ERR - '+Z.readyState)}function O(Z){if(Z.readyState===C.DONE)throw new Error('Request done')}function R(Z){if(Z.async&&Z.readyState!==C.HEADERS_RECEIVED)throw new Error('No headers received')}function I(Z){if('string'!==typeof Z){var J=new Error('Attempted to respond to fake XMLHttpRequest with '+Z+', which is not a string.');throw J.name='InvalidBodyException',J}}function P(Z){for(var ee,J=new ArrayBuffer(Z.length),Y=new Uint8Array(J),Q=0;Q<Z.length;Q++){if(ee=Z.charCodeAt(Q),256<=ee)throw new TypeError('arraybuffer or blob responseTypes require binary string, invalid character '+Z[Q]+' found.');Y[Q]=ee}return J}function q(Z){return!Z||/(text\/xml)|(application\/xml)|(\+xml)/.test(Z)}function N(Z,J,Y){if(''===Z||'text'===Z)return Y;if(_&&'arraybuffer'===Z)return P(Y);if('json'===Z)try{return JSON.parse(Y)}catch(ee){return null}else{if(V&&'blob'===Z){var Q={};return J&&(Q.type=J),new Blob([P(Y)],Q)}if('document'===Z)return q(J)?C.parseXML(Y):null}throw new Error('Invalid responseType '+Z)}function D(Z){Z.response=''===Z.responseType||'text'===Z.responseType?Z.responseText='':Z.responseText=null,Z.responseXML=null}function L(Z){Z.xhr=B,Z.extend(C.prototype,Z.EventTarget,{async:!0,open:function(Y,Q,ee,te,ne){if(this.method=Y,this.url=Q,this.async='boolean'!==typeof ee||ee,this.username=te,this.password=ne,D(this),this.requestHeaders={},this.sendFlag=!1,!0===C.useFilters){var ae=arguments,re=T(C.filters,function(oe){return oe.apply(this,ae)});if(re)return C.defake(this,arguments)}this.readyStateChange(C.OPENED)},readyStateChange:function(Y){this.readyState=Y;var Q=new Z.Event('readystatechange',!1,!1,this);if('function'===typeof this.onreadystatechange)try{this.onreadystatechange(Q)}catch(ee){Z.logError('Fake XHR onreadystatechange handler',ee)}switch(this.readyState){case C.DONE:X&&(this.upload.dispatchEvent(new Z.ProgressEvent('progress',{loaded:100,total:100})),this.dispatchEvent(new Z.ProgressEvent('progress',{loaded:100,total:100}))),this.upload.dispatchEvent(new Z.Event('load',!1,!1,this)),this.dispatchEvent(new Z.Event('load',!1,!1,this)),this.dispatchEvent(new Z.Event('loadend',!1,!1,this));}this.dispatchEvent(Q)},setRequestHeader:function(Y,Q){if(w(this),U[Y]||/^(Sec-|Proxy-)/.test(Y))throw new Error('Refused to set unsafe header "'+Y+'"');this.requestHeaders[Y]?this.requestHeaders[Y]+=','+Q:this.requestHeaders[Y]=Q},setResponseHeaders:function(Y){for(var Q in S(this),this.responseHeaders={},Y)Y.hasOwnProperty(Q)&&(this.responseHeaders[Q]=Y[Q]);this.async?this.readyStateChange(C.HEADERS_RECEIVED):this.readyState=C.HEADERS_RECEIVED},send:function(Y){if(w(this),!/^(get|head)$/i.test(this.method)){var Q=A(this.requestHeaders,'Content-Type');if(this.requestHeaders[Q]){var ee=this.requestHeaders[Q].split(';');this.requestHeaders[Q]=ee[0]+';charset=utf-8'}else W&&!(Y instanceof FormData)&&(this.requestHeaders['Content-Type']='text/plain;charset=utf-8');this.requestBody=Y}this.errorFlag=!1,this.sendFlag=this.async,D(this),this.readyStateChange(C.OPENED),'function'===typeof this.onSend&&this.onSend(this),this.dispatchEvent(new Z.Event('loadstart',!1,!1,this))},abort:function(){this.aborted=!0,D(this),this.errorFlag=!0,this.requestHeaders={},this.responseHeaders={},this.readyState>C.UNSENT&&this.sendFlag&&(this.readyStateChange(C.DONE),this.sendFlag=!1),this.readyState=C.UNSENT,this.dispatchEvent(new Z.Event('abort',!1,!1,this)),this.upload.dispatchEvent(new Z.Event('abort',!1,!1,this)),'function'===typeof this.onerror&&this.onerror()},getResponseHeader:function(Y){return this.readyState<C.HEADERS_RECEIVED?null:/^Set-Cookie2?$/i.test(Y)?null:(Y=A(this.responseHeaders,Y),this.responseHeaders[Y]||null)},getAllResponseHeaders:function(){if(this.readyState<C.HEADERS_RECEIVED)return'';var Y='';for(var Q in this.responseHeaders)this.responseHeaders.hasOwnProperty(Q)&&!/^Set-Cookie2?$/i.test(Q)&&(Y+=Q+': '+this.responseHeaders[Q]+'\r\n');return Y},setResponseBody:function(Y){O(this),R(this),I(Y);var Q=this.getResponseHeader('Content-Type'),ee=''===this.responseType||'text'===this.responseType;if(D(this),this.async){var te=this.chunkSize||10,ne=0;do this.readyStateChange(C.LOADING),ee&&(this.responseText=this.response+=Y.substring(ne,ne+te)),ne+=te;while(ne<Y.length)}this.response=N(this.responseType,Q,Y),ee&&(this.responseText=this.response),'document'===this.responseType?this.responseXML=this.response:''===this.responseType&&q(Q)&&(this.responseXML=C.parseXML(this.responseText)),this.readyStateChange(C.DONE)},respond:function(Y,Q,ee){this.status='number'===typeof Y?Y:200,this.statusText=C.statusCodes[this.status],this.setResponseHeaders(Q||{}),this.setResponseBody(ee||'')},uploadProgress:function(Y){X&&this.upload.dispatchEvent(new Z.ProgressEvent('progress',Y))},downloadProgress:function(Y){X&&this.dispatchEvent(new Z.ProgressEvent('progress',Y))},uploadError:function(Y){H&&this.upload.dispatchEvent(new Z.CustomEvent('error',{detail:Y}))}}),Z.extend(C,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),Z.useFakeXMLHttpRequest=function(){return C.restore=function(Y){B.supportsXHR&&(d.XMLHttpRequest=B.GlobalXMLHttpRequest),B.supportsActiveX&&(d.ActiveXObject=B.GlobalActiveXObject),delete C.restore,!0!==Y&&delete C.onCreate},B.supportsXHR&&(d.XMLHttpRequest=C),B.supportsActiveX&&(d.ActiveXObject=function(Y){return'Microsoft.XMLHTTP'===Y||/^Msxml2\.XMLHTTP/i.test(Y)?new C:new B.GlobalActiveXObject(Y)}),C},Z.FakeXMLHttpRequest=C}function M(Z,J,Y){var Q=Z('./core');Z('../extend'),Z('./event'),Z('../log_error'),L(Q),Y.exports=Q}var X='undefined'!==typeof ProgressEvent,H='undefined'!==typeof CustomEvent,W='undefined'!==typeof FormData,_='undefined'!==typeof ArrayBuffer,V='function'===typeof Blob,B={XMLHttpRequest:d.XMLHttpRequest};B.GlobalXMLHttpRequest=d.XMLHttpRequest,B.GlobalActiveXObject=d.ActiveXObject,B.supportsActiveX='undefined'!==typeof B.GlobalActiveXObject,B.supportsXHR='undefined'!==typeof B.GlobalXMLHttpRequest,B.workingXHR=function(Z){var J='undefined'!==typeof Z.XMLHttpRequest;if(J)return Z.XMLHttpRequest;var Y='undefined'!==typeof Z.ActiveXObject;return!!Y&&function(){return new Z.ActiveXObject('MSXML2.XMLHTTP.3.0')}}(d),B.supportsCORS=B.supportsXHR&&'withCredentials'in new B.GlobalXMLHttpRequest;var U={'Accept-Charset':!0,'Accept-Encoding':!0,Connection:!0,'Content-Length':!0,Cookie:!0,Cookie2:!0,'Content-Transfer-Encoding':!0,Date:!0,Expect:!0,Host:!0,'Keep-Alive':!0,Referer:!0,TE:!0,Trailer:!0,'Transfer-Encoding':!0,Upgrade:!0,'User-Agent':!0,Via:!0};y.prototype.addEventListener=function(J,Y){this.eventListeners[J].push(Y)},y.prototype.removeEventListener=function(J,Y){for(var Q=this.eventListeners[J]||[],ee=0,te=Q.length;ee<te;++ee)if(Q[ee]===Y)return Q.splice(ee,1)},y.prototype.dispatchEvent=function(J){for(var ee,Y=this.eventListeners[J.type]||[],Q=0;null!=(ee=Y[Q]);Q++)ee(J)};var G=function(Z,J,Y){switch(Y.length){case 0:return Z[J]();case 1:return Z[J](Y[0]);case 2:return Z[J](Y[0],Y[1]);case 3:return Z[J](Y[0],Y[1],Y[2]);case 4:return Z[J](Y[0],Y[1],Y[2],Y[3]);case 5:return Z[J](Y[0],Y[1],Y[2],Y[3],Y[4]);}};C.filters=[],C.addFilter=function(J){this.filters.push(J)};var K=/MSIE 6/;C.defake=function(J,Y){var Q=new B.workingXHR;E(['open','setRequestHeader','send','abort','getResponseHeader','getAllResponseHeaders','addEventListener','overrideMimeType','removeEventListener'],function(ae){J[ae]=function(){return G(Q,ae,arguments)}});var ee=function(ae){E(ae,function(re){try{J[re]=Q[re]}catch(oe){if(!K.test(navigator.userAgent))throw oe}})},te=function(){J.readyState=Q.readyState,Q.readyState>=C.HEADERS_RECEIVED&&ee(['status','statusText']),Q.readyState>=C.LOADING&&ee(['responseText','response']),Q.readyState===C.DONE&&ee(['responseXML']),J.onreadystatechange&&J.onreadystatechange.call(J,{target:J})};if(Q.addEventListener){for(var ne in J.eventListeners)J.eventListeners.hasOwnProperty(ne)&&E(J.eventListeners[ne],function(ae){Q.addEventListener(ne,ae)});Q.addEventListener('readystatechange',te)}else Q.onreadystatechange=te;G(Q,'open',Y)},C.useFilters=!1,C.parseXML=function(J){if(''!==J)try{if('undefined'!==typeof DOMParser){var Y=new DOMParser;return Y.parseFromString(J,'text/xml')}var Q=new window.ActiveXObject('Microsoft.XMLDOM');return Q.async='false',Q.loadXML(J),Q}catch(ee){}return null},C.statusCodes={100:'Continue',101:'Switching Protocols',200:'OK',201:'Created',202:'Accepted',203:'Non-Authoritative Information',204:'No Content',205:'Reset Content',206:'Partial Content',207:'Multi-Status',300:'Multiple Choice',301:'Moved Permanently',302:'Found',303:'See Other',304:'Not Modified',305:'Use Proxy',307:'Temporary Redirect',400:'Bad Request',401:'Unauthorized',402:'Payment Required',403:'Forbidden',404:'Not Found',405:'Method Not Allowed',406:'Not Acceptable',407:'Proxy Authentication Required',408:'Request Timeout',409:'Conflict',410:'Gone',411:'Length Required',412:'Precondition Failed',413:'Request Entity Too Large',414:'Request-URI Too Long',415:'Unsupported Media Type',416:'Requested Range Not Satisfiable',417:'Expectation Failed',422:'Unprocessable Entity',500:'Internal Server Error',501:'Not Implemented',502:'Bad Gateway',503:'Service Unavailable',504:'Gateway Timeout',505:'HTTP Version Not Supported'};var z='undefined'!==typeof module&&module.exports&&'function'===typeof require,$='function'===typeof define&&'object'===typeof define.amd&&define.amd;return $?void define(M):z?void M(require,module.exports,module):void(c&&L(c))}('object'===typeof sinon&&sinon,'undefined'===typeof global?self:global),function(){function c(O){var R=O;if('[object Array]'!==Object.prototype.toString.call(O)&&(R=[200,{},O]),'string'!==typeof R[2])throw new TypeError('Fake server response body should be string, but was '+typeof R[2]);return R}function d(O,R,I){var P=O.method,q=!P||P.toLowerCase()===R.toLowerCase(),N=O.url,D=!N||N===I||'function'===typeof N.test&&N.test(I);return q&&D}function g(O,R){var I=R.url;if((!/^https?:\/\//.test(I)||E.test(I))&&(I=I.replace(E,'')),d(O,this.getHTTPMethod(R),I)){if('function'===typeof O.response){var P=O.url,q=[R].concat(P&&'function'===typeof P.exec?P.exec(I).slice(1):[]);return O.response.apply(O,q)}return!0}return!1}function y(O){O.fakeServer={create:function(R){var I=O.create(this);return I.configure(R),this.xhr=O.xhr.supportsCORS?O.useFakeXMLHttpRequest():O.useFakeXDomainRequest(),I.requests=[],this.xhr.onCreate=function(P){I.addRequest(P)},I},configure:function(R){var P,I={autoRespond:!0,autoRespondAfter:!0,respondImmediately:!0,fakeHTTPMethods:!0};for(P in R=R||{},R)I.hasOwnProperty(P)&&R.hasOwnProperty(P)&&(this[P]=R[P])},addRequest:function(I){var P=this;w.call(this.requests,I),I.onSend=function(){P.handleRequest(this),P.respondImmediately?P.respond():P.autoRespond&&!P.responding&&(setTimeout(function(){P.responding=!1,P.respond()},P.autoRespondAfter||10),P.responding=!0)}},getHTTPMethod:function(I){if(this.fakeHTTPMethods&&/post/i.test(I.method)){var P=(I.requestBody||'').match(/_method=([^\b;]+)/);return P?P[1]:I.method}return I.method},handleRequest:function(I){I.async?(!this.queue&&(this.queue=[]),w.call(this.queue,I)):this.processRequest(I)},log:function(I,P){var q;q='Request:\n'+O.format(P)+'\n\n',q+='Response:\n'+O.format(I)+'\n\n',O.log(q)},respondWith:function(I,P,q){return 1===arguments.length&&'function'!==typeof I?void(this.response=c(I)):void(!this.responses&&(this.responses=[]),1===arguments.length&&(q=I,P=I=null),2===arguments.length&&(q=P,P=I,I=null),w.call(this.responses,{method:I,url:P,response:'function'===typeof q?q:c(q)}))},respond:function(){0<arguments.length&&this.respondWith.apply(this,arguments);for(var I=this.queue||[],P=I.splice(0,I.length),q=0;q<P.length;q++)this.processRequest(P[q])},processRequest:function(I){try{if(I.aborted)return;var P=this.response||[404,{},''];if(this.responses)for(var q=this.responses.length,N=q-1;0<=N;N--)if(g.call(this,this.responses[N],I)){P=this.responses[N].response;break}4!==I.readyState&&(this.log(P,I),I.respond(P[0],P[1],P[2]))}catch(D){O.logError('Fake server request processing',D)}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}function C(O,R,I){var P=O('./core');O('./fake_xdomain_request'),O('./fake_xml_http_request'),O('../format'),y(P),I.exports=P}var w=[].push,A='undefined'===typeof window?{}:window.location,E=new RegExp('^'+A.protocol+'//'+A.host),T='undefined'!==typeof module&&module.exports&&'function'===typeof require,S='function'===typeof define&&'object'===typeof define.amd&&define.amd;S?define(C):T?C(require,module.exports,module):y(sinon)}(),function(){function c(C){function w(){}w.prototype=C.fakeServer,C.fakeServerWithClock=new w,C.fakeServerWithClock.addRequest=function(E){if(E.async&&('object'===typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=C.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var T=this.clock.setTimeout,S=this.clock.setInterval,O=this;this.clock.setTimeout=function(R,I){return O.longestTimeout=Math.max(I,O.longestTimeout||0),T.apply(this,arguments)},this.clock.setInterval=function(R,I){return O.longestTimeout=Math.max(I,O.longestTimeout||0),S.apply(this,arguments)}}return C.fakeServer.addRequest.call(this,E)},C.fakeServerWithClock.respond=function(){var E=C.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),E},C.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),C.fakeServer.restore.apply(this,arguments)}}function d(C){var w=C('./core');C('./fake_server'),C('./fake_timers'),c(w)}var g='undefined'!==typeof module&&module.exports&&'function'===typeof require,y='function'===typeof define&&'object'===typeof define.amd&&define.amd;y?define(d):g?d(require):c(sinon)}(),function(c){function d(w){function A(S,O,R,I){I&&(O.injectInto&&!(R in O.injectInto)?(O.injectInto[R]=I,S.injectedKeys.push(R)):T.call(S.args,I))}function E(S){var O=w.create(w.sandbox);return S.useFakeServer&&('object'===typeof S.useFakeServer&&(O.serverPrototype=S.useFakeServer),O.useFakeServer()),S.useFakeTimers&&('object'===typeof S.useFakeTimers?O.useFakeTimers.apply(O,S.useFakeTimers):O.useFakeTimers()),O}var T=[].push;return w.sandbox=w.extend(w.create(w.collection),{useFakeTimers:function(){return this.clock=w.useFakeTimers.apply(w,arguments),this.add(this.clock)},serverPrototype:w.fakeServer,useFakeServer:function(){var O=this.serverPrototype||w.fakeServer;return O&&O.create?(this.server=O.create(),this.add(this.server)):null},inject:function(S){return w.collection.inject.call(this,S),this.clock&&(S.clock=this.clock),this.server&&(S.server=this.server,S.requests=this.server.requests),S.match=w.match,S},restore:function(){w.collection.restore.apply(this,arguments),this.restoreContext()},restoreContext:function(){if(this.injectedKeys){for(var S=0,O=this.injectedKeys.length;S<O;S++)delete this.injectInto[this.injectedKeys[S]];this.injectedKeys=[]}},create:function(S){if(!S)return w.create(w.sandbox);var O=E(S);O.args=O.args||[],O.injectedKeys=[],O.injectInto=S.injectInto;var R,I,P=O.inject({});if(S.properties)for(var q=0,N=S.properties.length;q<N;q++)R=S.properties[q],I=P[R]||'sandbox'===R&&O,A(O,S,R,I);else A(O,S,'sandbox',I);return O},match:w.match}),w.sandbox.useFakeXMLHttpRequest=w.sandbox.useFakeServer,w.sandbox}function g(w,A,E){var T=w('./util/core');w('./extend'),w('./util/fake_server_with_clock'),w('./util/fake_timers'),w('./collection'),E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;return C?void define(g):y?void g(require,module.exports,module):void(c&&d(c))}('object'===typeof sinon&&sinon),function(c){function d(w){function A(T){function S(){var R=w.getConfig(w.config);R.injectInto=R.injectIntoThis&&this||R.injectInto;var N,D,I=w.sandbox.create(R),P=E.call(arguments),q=P.length&&P[P.length-1];'function'===typeof q&&(P[P.length-1]=function(M){M?I.restore():I.verifyAndRestore(),q(M)});try{D=T.apply(this,P.concat(I.args))}catch(L){N=L}if('function'!==typeof q)if('undefined'!==typeof N)throw I.restore(),N;else I.verifyAndRestore();return D}var O=typeof T;if('function'!==O)throw new TypeError('sinon.test needs to wrap a test function, got '+O);return T.length?function(){return S.apply(this,arguments)}:S}var E=Array.prototype.slice;return A.config={injectIntoThis:!0,injectInto:null,properties:['spy','stub','mock','clock','server','requests'],useFakeTimers:!0,useFakeServer:!0},w.test=A,A}function g(w,A,E){var T=w('./util/core');w('./sandbox'),E.exports=d(T)}var y='undefined'!==typeof module&&module.exports&&'function'===typeof require,C='function'===typeof define&&'object'===typeof define.amd&&define.amd;C?define(g):y?g(require,module.exports,module):c&&d(c)}('object'===typeof sinon&&sinon||null),function(c){function d(A,E,T){return function(){E&&E.apply(this,arguments);var S,O;try{O=A.apply(this,arguments)}catch(R){S=R}if(T&&T.apply(this,arguments),S)throw S;return O}}function g(A){function E(T,S){if(!T||'object'!==typeof T)throw new TypeError('sinon.testCase needs an object with test functions');S=S||'test';var q,N,D,O=new RegExp('^'+S),R={},I=T.setUp,P=T.tearDown;for(q in T)T.hasOwnProperty(q)&&!/^(setUp|tearDown)$/.test(q)&&(N=T[q],'function'===typeof N&&O.test(q)?(D=N,(I||P)&&(D=d(N,I,P)),R[q]=A.test(D)):R[q]=T[q]);return R}return A.testCase=E,E}function y(A,E,T){var S=A('./util/core');A('./test'),T.exports=g(S)}var C='undefined'!==typeof module&&module.exports&&'function'===typeof require,w='function'===typeof define&&'object'===typeof define.amd&&define.amd;return w?void define(y):C?void y(require,module.exports,module):void(c&&g(c))}('object'===typeof sinon&&sinon),function(c,d){function g(E){function T(){for(var P,q=0,N=arguments.length;q<N;++q)P=arguments[q],P||I.fail('fake is not a spy'),P.proxy&&P.proxy.isSinonProxy?T(P.proxy):('function'!==typeof P&&I.fail(P+' is not a function'),'function'!==typeof P.getCall&&I.fail(P+' is not stubbed'))}function S(P,q){P=P||d;var N=P.fail||I.fail;N.call(P,q)}function O(P,q,N){2===arguments.length&&(N=q,q=P),I[P]=function(D){T(D);var L=C.call(arguments,1),M=!1;M='function'===typeof q?!q(D):'function'===typeof D[q]?!D[q].apply(D,L):!D[q],M?S(this,(D.printf||D.proxy.printf).apply(D,[N].concat(L))):I.pass(P)}}function R(P,q){return!P||/^fail/.test(q)?q:P+q.slice(0,1).toUpperCase()+q.slice(1)}var I;return I={failException:'AssertError',fail:function(q){var N=new Error(q);throw N.name=this.failException||I.failException,N},pass:function(){},callOrder:function(){T.apply(null,arguments);var q='',N='';if(!E.calledInOrder(arguments)){try{q=[].join.call(arguments,', ');for(var D=C.call(arguments),L=D.length;L;)D[--L].called||D.splice(L,1);N=E.orderByFirstCall(D).join(', ')}catch(M){}S(this,'expected '+q+' to be called in order but were called as '+N)}else I.pass('callOrder')},callCount:function(q,N){if(T(q),q.callCount!==N){var D='expected %n to be called '+E.timesInWords(N)+' but was called %c%C';S(this,q.printf(D))}else I.pass('callCount')},expose:function(q,N){if(!q)throw new TypeError('target is null or undefined');var D=N||{},L='undefined'===typeof D.prefix&&'assert'||D.prefix,M='undefined'===typeof D.includeFail||!!D.includeFail;for(var X in this)'expose'!==X&&(M||!/^(fail)/.test(X))&&(q[R(L,X)]=this[X]);return q},match:function(q,N){var D=E.match(N);if(D.test(q))I.pass('match');else{var L=['expected value to match','    expected = '+E.format(N),'    actual = '+E.format(q)];S(this,L.join('\n'))}}},O('called','expected %n to have been called at least once but was never called'),O('notCalled',function(P){return!P.called},'expected %n to not have been called but was called %c%C'),O('calledOnce','expected %n to be called once but was called %c%C'),O('calledTwice','expected %n to be called twice but was called %c%C'),O('calledThrice','expected %n to be called thrice but was called %c%C'),O('calledOn','expected %n to be called with %1 as this but was called with %t'),O('alwaysCalledOn','expected %n to always be called with %1 as this but was called with %t'),O('calledWithNew','expected %n to be called with new'),O('alwaysCalledWithNew','expected %n to always be called with new'),O('calledWith','expected %n to be called with arguments %*%C'),O('calledWithMatch','expected %n to be called with match %*%C'),O('alwaysCalledWith','expected %n to always be called with arguments %*%C'),O('alwaysCalledWithMatch','expected %n to always be called with match %*%C'),O('calledWithExactly','expected %n to be called with exact arguments %*%C'),O('alwaysCalledWithExactly','expected %n to always be called with exact arguments %*%C'),O('neverCalledWith','expected %n to never be called with arguments %*%C'),O('neverCalledWithMatch','expected %n to never be called with match %*%C'),O('threw','%n did not throw exception%C'),O('alwaysThrew','%n did not always throw exception%C'),E.assert=I,I}function y(E,T,S){var O=E('./util/core');E('./match'),E('./format'),S.exports=g(O)}var C=Array.prototype.slice,w='undefined'!==typeof module&&module.exports&&'function'===typeof require,A='function'===typeof define&&'object'===typeof define.amd&&define.amd;return A?void define(y):w?void y(require,module.exports,module):void(c&&g(c))}('object'===typeof sinon&&sinon,'undefined'===typeof global?self:global),sinon});